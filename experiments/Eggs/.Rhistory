axis.title.x = element_text(size=50), axis.title.y = element_text(size=40), legend.position = "none",strip.text=element_text(size=30))+
theme(axis.title.x = element_text(vjust=-0.3), axis.title.y = element_text(vjus =1.8))+
theme(plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"))+
scale_fill_manual(values=c("#CA3542", "#AECBC9"))+
facet_wrap(~geno,scales="free_x")
maleplot_segment
maleplot_segment <- ggplot(aes(y=winfrac, x=line, fill=allele), data=interbars)+
geom_bar(stat="identity", colour="black", position="dodge")+
geom_errorbar(aes(ymin=winfrac-se, ymax=winfrac+se),
width=.2,
position=position_dodge(.9))+
geom_segment(aes(x=x1, y=y1, xend=x2, yend=y2), data=dfS, inherit.aes = FALSE, linetype=2, size=1.5)+
geom_segment(aes(x=x1, y=y1, xend=x2, yend=y2), data=dfL, inherit.aes = FALSE, linetype=2, size=1.5)+
ylab("Proportion of matings by focal males")+
xlab("Line")+
theme_bw()+
theme(axis.text = element_text(size=30),
axis.title.x = element_text(size=50), axis.title.y = element_text(size=40), legend.position = "none",strip.text=element_text(size=30))+
theme(axis.title.x = element_text(vjust=-0.3), axis.title.y = element_text(vjus =2))+
theme(plot.margin = unit(c(0.1,0.1,0.5,0.5), "cm"))+
scale_fill_manual(values=c("#CA3542", "#AECBC9"))+
facet_wrap(~geno,scales="free_x")
maleplot_segment
maleplot_segment <- ggplot(aes(y=winfrac, x=line, fill=allele), data=interbars)+
geom_bar(stat="identity", colour="black", position="dodge")+
geom_errorbar(aes(ymin=winfrac-se, ymax=winfrac+se),
width=.2,
position=position_dodge(.9))+
geom_segment(aes(x=x1, y=y1, xend=x2, yend=y2), data=dfS, inherit.aes = FALSE, linetype=2, size=1.5)+
geom_segment(aes(x=x1, y=y1, xend=x2, yend=y2), data=dfL, inherit.aes = FALSE, linetype=2, size=1.5)+
ylab("Proportion of matings by focal males")+
xlab("Line")+
theme_bw()+
theme(axis.text = element_text(size=30),
axis.title.x = element_text(size=50), axis.title.y = element_text(size=40), legend.position = "none",strip.text=element_text(size=30))+
theme(axis.title.x = element_text(vjust=-0.4), axis.title.y = element_text(vjus =2.1))+
theme(plot.margin = unit(c(0.1,0.1,0.5,0.5), "cm"))+
scale_fill_manual(values=c("#CA3542", "#AECBC9"))+
facet_wrap(~geno,scales="free_x")
maleplot_segment
maleplot_segment <- ggplot(aes(y=winfrac, x=line, fill=allele), data=interbars)+
geom_bar(stat="identity", colour="black", position="dodge")+
geom_errorbar(aes(ymin=winfrac-se, ymax=winfrac+se),
width=.2,
position=position_dodge(.9))+
geom_segment(aes(x=x1, y=y1, xend=x2, yend=y2), data=dfS, inherit.aes = FALSE, linetype=2, size=1.5)+
geom_segment(aes(x=x1, y=y1, xend=x2, yend=y2), data=dfL, inherit.aes = FALSE, linetype=2, size=1.5)+
ylab("Proportion of matings by focal males")+
xlab("Line")+
theme_bw()+
theme(axis.text = element_text(size=30),
axis.title.x = element_text(size=50), axis.title.y = element_text(size=40), legend.position = "none",strip.text=element_text(size=30))+
theme(axis.title.x = element_text(vjust=-0.4), axis.title.y = element_text(vjus =2.2))+
theme(plot.margin = unit(c(0.1,0.1,0.5,0.5), "cm"))+
scale_fill_manual(values=c("#CA3542", "#AECBC9"))+
facet_wrap(~geno,scales="free_x")
maleplot_segment
maleplot_segment <- ggplot(aes(y=winfrac, x=line, fill=allele), data=interbars)+
geom_bar(stat="identity", colour="black", position="dodge")+
geom_errorbar(aes(ymin=winfrac-se, ymax=winfrac+se),
width=.2,
position=position_dodge(.9))+
geom_segment(aes(x=x1, y=y1, xend=x2, yend=y2), data=dfS, inherit.aes = FALSE, linetype=2, size=1.5)+
geom_segment(aes(x=x1, y=y1, xend=x2, yend=y2), data=dfL, inherit.aes = FALSE, linetype=2, size=1.5)+
ylab("Proportion of matings by focal males")+
xlab("Line")+
theme_bw()+
theme(axis.text = element_text(size=30),
axis.title.x = element_text(size=45), axis.title.y = element_text(size=45), legend.position = "none",strip.text=element_text(size=30))+
theme(axis.title.x = element_text(vjust=-0.4), axis.title.y = element_text(vjus =2.2))+
theme(plot.margin = unit(c(0.1,0.1,0.7,0.7), "cm"))+
scale_fill_manual(values=c("#CA3542", "#AECBC9"))+
facet_wrap(~geno,scales="free_x")
maleplot_segment
maleplot_segment <- ggplot(aes(y=winfrac, x=line, fill=allele), data=interbars)+
geom_bar(stat="identity", colour="black", position="dodge")+
geom_errorbar(aes(ymin=winfrac-se, ymax=winfrac+se),
width=.2,
position=position_dodge(.9))+
geom_segment(aes(x=x1, y=y1, xend=x2, yend=y2), data=dfS, inherit.aes = FALSE, linetype=2, size=1.5)+
geom_segment(aes(x=x1, y=y1, xend=x2, yend=y2), data=dfL, inherit.aes = FALSE, linetype=2, size=1.5)+
ylab("Proportion of matings by focal males")+
xlab("Line")+
theme_bw()+
theme(axis.text = element_text(size=30),
axis.title.x = element_text(size=45), axis.title.y = element_text(size=45), legend.position = "none",strip.text=element_text(size=30))+
theme(axis.title.x = element_text(vjust=-0.4), axis.title.y = element_text(vjus =2.2, hjust = 0.5))+
theme(plot.margin = unit(c(0.1,0.1,0.7,0.7), "cm"))+
scale_fill_manual(values=c("#CA3542", "#AECBC9"))+
facet_wrap(~geno,scales="free_x")
maleplot_segment
maleplot_segment <- ggplot(aes(y=winfrac, x=line, fill=allele), data=interbars)+
geom_bar(stat="identity", colour="black", position="dodge")+
geom_errorbar(aes(ymin=winfrac-se, ymax=winfrac+se),
width=.2,
position=position_dodge(.9))+
geom_segment(aes(x=x1, y=y1, xend=x2, yend=y2), data=dfS, inherit.aes = FALSE, linetype=2, size=1.5)+
geom_segment(aes(x=x1, y=y1, xend=x2, yend=y2), data=dfL, inherit.aes = FALSE, linetype=2, size=1.5)+
ylab("Proportion of matings by focal males")+
xlab("Line")+
theme_bw()+
theme(axis.text = element_text(size=30),
axis.title.x = element_text(size=45), axis.title.y = element_text(size=45), legend.position = "none",strip.text=element_text(size=30))+
theme(axis.title.x = element_text(vjust=-0.4), axis.title.y = element_text(vjus =2.2, hjust = 0.5))+
theme(plot.margin = unit(c(0.3,0.1,0.7,0.7), "cm"))+
scale_fill_manual(values=c("#CA3542", "#AECBC9"))+
facet_wrap(~geno,scales="free_x")
maleplot_segment
maleplot_segment <- ggplot(aes(y=winfrac, x=line, fill=allele), data=interbars)+
geom_bar(stat="identity", colour="black", position="dodge")+
geom_errorbar(aes(ymin=winfrac-se, ymax=winfrac+se),
width=.2,
position=position_dodge(.9))+
geom_segment(aes(x=x1, y=y1, xend=x2, yend=y2), data=dfS, inherit.aes = FALSE, linetype=2, size=1.5)+
geom_segment(aes(x=x1, y=y1, xend=x2, yend=y2), data=dfL, inherit.aes = FALSE, linetype=2, size=1.5)+
ylab("Proportion of matings by focal males")+
xlab("Line")+
theme_bw()+
theme(axis.text = element_text(size=30),
axis.title.x = element_text(size=45), axis.title.y = element_text(size=45), legend.position = "none",strip.text=element_text(size=30))+
theme(axis.title.x = element_text(vjust=-0.4), axis.title.y = element_text(vjus =2.2, hjust = 0.5))+
theme(plot.margin = unit(c(0.5,0.1,0.7,0.7), "cm"))+
scale_fill_manual(values=c("#CA3542", "#AECBC9"))+
facet_wrap(~geno,scales="free_x")
maleplot_segment
ggsave("Plots/maleplot_red_blue_segment_lines.png")
dfS <- data.frame(genotype=c("B", "D"), x1=c(3.6, 3.6), x2 = c(6.5,6.5), y1=c(26.03, 29.67), y2=c(26.03, 29.67))
dfL <- data.frame(genotype=c("B", "D"), x1=c(0.5, 0.5), x2 = c(3.4, 3.4), y1=c(23.52, 23.57), y2=c(23.52, 23.57))
eggplot_points <- ggplot(aes(y=Predicted.count.,x=line,fill=allele), data=Teggs)+
geom_boxplot(outlier.shape = NA)+
geom_point(aes(fill = allele), size = 2, shape = 21, position = position_jitterdodge(0.5)) +
geom_segment(aes(x=x1, y=y1, xend=x2, yend=y2), data=dfS, inherit.aes = FALSE, linetype=2, size=1.5)+
geom_segment(aes(x=x1, y=y1, xend=x2, yend=y2), data=dfL, inherit.aes = FALSE, linetype=2, size=1.5)+
ylab("Number of eggs laid")+
xlab("Line")+
theme_bw()+
theme(axis.text = element_text(size=30),
axis.title.x = element_text(size=45), axis.title.y = element_text(size=45), legend.position = "none",strip.text=element_text(size=30))+
theme(axis.title.x = element_text(vjust=-0.4), axis.title.y = element_text(vjus =2.2, hjust = 0.5))+
theme(plot.margin = unit(c(0.5,0.1,0.7,0.7), "cm"))+
theme(legend.position="none")+
scale_fill_manual(values=c("#aecbc9", "#ca3542"))+
facet_wrap(~genotype,scales="free_x")
eggplot_points
dfS <- data.frame(genotype=c("B", "D"), x1=c(3.6, 3.6), x2 = c(6.5,6.5), y1=c(26.03, 29.67), y2=c(26.03, 29.67))
dfL <- data.frame(genotype=c("B", "D"), x1=c(0.5, 0.5), x2 = c(3.4, 3.4), y1=c(23.52, 23.57), y2=c(23.52, 23.57))
eggplot_points <- ggplot(aes(y=Predicted.count.,x=line,fill=allele), data=Teggs)+
geom_boxplot(outlier.shape = NA)+
geom_point(aes(fill = allele), size = 2, shape = 21, position = position_jitterdodge(0.5)) +
geom_segment(aes(x=x1, y=y1, xend=x2, yend=y2), data=dfS, inherit.aes = FALSE, linetype=2, size=1.5)+
geom_segment(aes(x=x1, y=y1, xend=x2, yend=y2), data=dfL, inherit.aes = FALSE, linetype=2, size=1.5)+
ylab("Number of eggs laid")+
xlab("Line")+
theme_bw()+
theme(axis.text = element_text(size=30),
axis.title.x = element_text(size=45), axis.title.y = element_text(size=45), legend.position = "none",strip.text=element_text(size=30))+
theme(axis.title.x = element_text(vjust=-0.4), axis.title.y = element_text(vjus =2.5, hjust = 0.5))+
theme(plot.margin = unit(c(0.5,0.1,0.7,0.7), "cm"))+
theme(legend.position="none")+
scale_fill_manual(values=c("#aecbc9", "#ca3542"))+
facet_wrap(~genotype,scales="free_x")
eggplot_points
dfS <- data.frame(geno=c("B", "D"), x1=c(3.6, 3.6), x2 = c(6.5, 6.5), y1=c(0.4687, 0.4), y2=c(0.4687, 0.4))
dfL <- data.frame(geno=c("B", "D"), x1=c(0.5, 0.5), x2 = c(3.4, 3.4), y1=c(0.4695, 0.3), y2=c(0.4695, 0.3))
maleplot_segment <- ggplot(aes(y=winfrac, x=line, fill=allele), data=interbars)+
geom_bar(stat="identity", colour="black", position="dodge")+
geom_errorbar(aes(ymin=winfrac-se, ymax=winfrac+se),
width=.2,
position=position_dodge(.9))+
geom_segment(aes(x=x1, y=y1, xend=x2, yend=y2), data=dfS, inherit.aes = FALSE, linetype=2, size=1.5)+
geom_segment(aes(x=x1, y=y1, xend=x2, yend=y2), data=dfL, inherit.aes = FALSE, linetype=2, size=1.5)+
ylab("Proportion of matings by focal males")+
xlab("Line")+
theme_bw()+
theme(axis.text = element_text(size=30),
axis.title.x = element_text(size=45), axis.title.y = element_text(size=45), legend.position = "none",strip.text=element_text(size=30))+
theme(axis.title.x = element_text(vjust=-0.4), axis.title.y = element_text(vjus =2.5, hjust = 0.5))+
theme(plot.margin = unit(c(0.5,0.1,0.7,0.7), "cm"))+
scale_fill_manual(values=c("#CA3542", "#AECBC9"))+
facet_wrap(~geno,scales="free_x")
maleplot_segment
eggplot_points
setwd("/Users/michaeljardine/Desktop/DTP/Data and analysis/fruitless/Eggs/")
ggsave("Plots/eggsplot_points_blue_red.png")
setwd("/Users/michaeljardine/Desktop/DTP/Data and analysis/fruitless/larvalsurvivalsummer2019/block3_chro_comp")
dfS <- data.frame(chro=c("B", "D"), x1=c(3.6, 3.6), x2 = c(6.5, 6.5), y1=c(7.775, 9.975), y2=c(7.775, 9.975))
dfL <- data.frame(chro=c("B", "D"), x1=c(0.5, 0.5), x2 = c(3.4, 3.4), y1=c(12.22, 14.62), y2=c(12.22, 14.62))
total.surving.offspring_points <- ggplot(aes(y=total, x=Line,fill=allele), data=Larval.surv.chro)+
geom_boxplot(outlier.shape = NA)+
geom_point(aes(fill = allele), size = 2, shape = 21, position = position_jitterdodge(0.8))+
geom_segment(aes(x=x1, y=y1, xend=x2, yend=y2), data=dfS, inherit.aes = FALSE, linetype=2, size=1.5)+
geom_segment(aes(x=x1, y=y1, xend=x2, yend=y2), data=dfL, inherit.aes = FALSE, linetype=2, size=1.5)+
ylab("Number of offspring surving to adulthood")+
xlab("Line")+
theme_bw()+
theme(axis.text = element_text(size=30),
axis.title.x = element_text(size=45), axis.title.y = element_text(size=45), legend.position = "none",strip.text=element_text(size=30))+
theme(axis.title.x = element_text(vjust=-0.4), axis.title.y = element_text(vjus =2.5, hjust = 0.5))+
theme(plot.margin = unit(c(0.5,0.1,0.7,0.7), "cm"))+
theme(legend.position="none")+
theme(legend.position="none")+
scale_fill_manual(values=c("#CA3542", "#AECBC9"))+
facet_wrap(~chro,scales="free_x")
total.surving.offspring_points
total.surving.offspring_points <- ggplot(aes(y=total, x=Line,fill=allele), data=Larval.surv.chro)+
geom_boxplot(outlier.shape = NA)+
geom_point(aes(fill = allele), size = 2, shape = 21, position = position_jitterdodge(0.8))+
geom_segment(aes(x=x1, y=y1, xend=x2, yend=y2), data=dfS, inherit.aes = FALSE, linetype=2, size=1.5)+
geom_segment(aes(x=x1, y=y1, xend=x2, yend=y2), data=dfL, inherit.aes = FALSE, linetype=2, size=1.5)+
ylab("No. of offspring surving to adulthood")+
xlab("Line")+
theme_bw()+
theme(axis.text = element_text(size=30),
axis.title.x = element_text(size=45), axis.title.y = element_text(size=45), legend.position = "none",strip.text=element_text(size=30))+
theme(axis.title.x = element_text(vjust=-0.4), axis.title.y = element_text(vjus =2.5, hjust = 0.5))+
theme(plot.margin = unit(c(0.5,0.1,0.7,0.7), "cm"))+
theme(legend.position="none")+
theme(legend.position="none")+
scale_fill_manual(values=c("#CA3542", "#AECBC9"))+
facet_wrap(~chro,scales="free_x")
total.surving.offspring_points
total.surving.offspring_points
ggsave("Plots/total_offspring_surving_points.png")
dfS <- data.frame(chro=c("B", "D"), x1=c(3.6, 3.6), x2 = c(6.5, 6.5), y1=c(0.466, 0.523), y2=c(0.466, 0.523))
dfL <- data.frame(chro=c("B", "D"), x1=c(0.5, 0.5), x2 = c(3.4, 3.4), y1=c(0.476, 0.476), y2=c(0.476, 0.476))
sex.ratio_points <- ggplot(aes(y=propmale, x=Line,fill=allele), data=Larval.surv.chro)+
geom_boxplot(outlier.shape = NA)+
geom_point(aes(fill = allele), size = 2, shape = 21, position = position_jitterdodge(0.8))+
geom_segment(aes(x=x1, y=y1, xend=x2, yend=y2), data=dfS, inherit.aes = FALSE, linetype=2, size=1.5)+
geom_segment(aes(x=x1, y=y1, xend=x2, yend=y2), data=dfL, inherit.aes = FALSE, linetype=2, size=1.5)+
ylab("Sex ratio")+
xlab("Line")+
theme_bw()+
theme(axis.text = element_text(size=30),
axis.title.x = element_text(size=45), axis.title.y = element_text(size=45), legend.position = "none",strip.text=element_text(size=30))+
theme(axis.title.x = element_text(vjust=-0.4), axis.title.y = element_text(vjus =2.5, hjust = 0.5))+
theme(plot.margin = unit(c(0.5,0.1,0.7,0.7), "cm"))+
theme(legend.position="none")+
scale_fill_manual(values=c("#CA3542", "#AECBC9"))+
facet_wrap(~chro,scales="free_x")
sex.ratio_points
ggsave("Plots/sex_ratio_surviving_offspring_points.png")
dfS <- data.frame(chro=c("B", "D"), x1=c(3.6, 3.6), x2 = c(6.5, 6.5), y1=c(10.304, 10.584), y2=c(10.304, 10.584))
dfL <- data.frame(chro=c("B", "D"), x1=c(0.5, 0.5), x2 = c(3.4, 3.4), y1=c(10.19, 10.47), y2=c(10.19, 10.47))
dev.time.line <- ggplot(aes(x=line, y=eclosion_date, color=allele), data=line.plots)+
geom_point(size=8)+
geom_errorbar(aes(ymin=(eclosion_date-se), ymax=(eclosion_date+se)), size=3.5)+
geom_segment(aes(x=x1, y=y1, xend=x2, yend=y2), data=dfS, inherit.aes = FALSE, linetype=2, size=1.5)+
geom_segment(aes(x=x1, y=y1, xend=x2, yend=y2), data=dfL, inherit.aes = FALSE, linetype=2, size=1.5)+
ylab("Development time (days)")+
xlab("Line")+
theme_bw()+
theme(axis.text = element_text(size=30),
axis.title.x = element_text(size=45), axis.title.y = element_text(size=45), legend.position = "none",strip.text=element_text(size=30))+
theme(axis.title.x = element_text(vjust=-0.4), axis.title.y = element_text(vjus =2.5, hjust = 0.5))+
scale_color_manual(values=c("#CA3542", "#AECBC9"))+
facet_wrap(~chro,scales="free_x")
dev.time.line
dev.time.line <- ggplot(aes(x=line, y=eclosion_date, color=allele), data=line.plots)+
geom_point(size=8)+
geom_errorbar(aes(ymin=(eclosion_date-se), ymax=(eclosion_date+se)), size=3.5)+
geom_segment(aes(x=x1, y=y1, xend=x2, yend=y2), data=dfS, inherit.aes = FALSE, linetype=2, size=1.5)+
geom_segment(aes(x=x1, y=y1, xend=x2, yend=y2), data=dfL, inherit.aes = FALSE, linetype=2, size=1.5)+
ylab("Development time (days)")+
xlab("Line")+
theme_bw()+
theme(axis.text = element_text(size=30),
axis.title.x = element_text(size=45), axis.title.y = element_text(size=45), legend.position = "none",strip.text=element_text(size=30))+
theme(axis.title.x = element_text(vjust=-0.4), axis.title.y = element_text(vjus =2.1, hjust = 0.5))+
scale_color_manual(values=c("#CA3542", "#AECBC9"))+
facet_wrap(~chro,scales="free_x")
dev.time.line
dev.time.line <- ggplot(aes(x=line, y=eclosion_date, color=allele), data=line.plots)+
geom_point(size=8)+
geom_errorbar(aes(ymin=(eclosion_date-se), ymax=(eclosion_date+se)), size=3.5)+
geom_segment(aes(x=x1, y=y1, xend=x2, yend=y2), data=dfS, inherit.aes = FALSE, linetype=2, size=1.5)+
geom_segment(aes(x=x1, y=y1, xend=x2, yend=y2), data=dfL, inherit.aes = FALSE, linetype=2, size=1.5)+
ylab("Development time (days)")+
xlab("Line")+
theme_bw()+
theme(axis.text = element_text(size=30),
axis.title.x = element_text(size=45), axis.title.y = element_text(size=45), legend.position = "none",strip.text=element_text(size=30))+
theme(axis.title.x = element_text(vjust=-0.4), axis.title.y = element_text(vjus =1.5, hjust = 0.5))+
scale_color_manual(values=c("#CA3542", "#AECBC9"))+
facet_wrap(~chro,scales="free_x")
dev.time.line
dev.time.line <- ggplot(aes(x=line, y=eclosion_date, color=allele), data=line.plots)+
geom_point(size=8)+
geom_errorbar(aes(ymin=(eclosion_date-se), ymax=(eclosion_date+se)), size=3.5)+
geom_segment(aes(x=x1, y=y1, xend=x2, yend=y2), data=dfS, inherit.aes = FALSE, linetype=2, size=1.5)+
geom_segment(aes(x=x1, y=y1, xend=x2, yend=y2), data=dfL, inherit.aes = FALSE, linetype=2, size=1.5)+
ylab("Development time (days)")+
xlab("Line")+
theme_bw()+
theme(axis.text = element_text(size=30),
axis.title.x = element_text(size=45), axis.title.y = element_text(size=45), legend.position = "none",strip.text=element_text(size=30))+
theme(axis.title.x = element_text(vjust=-0.4), axis.title.y = element_text(vjus =2.5, hjust = 0.5))+
theme(plot.margin = unit(c(0.5,0.1,0.7,0.7), "cm"))+
scale_color_manual(values=c("#CA3542", "#AECBC9"))+
facet_wrap(~chro,scales="free_x")
dev.time.line
ggsave("Plots/development_time_line_point_plot.png")
dev.time.sex <- ggplot(aes(x=sex, y=eclosion_date, color=sex), data=sex_plots)+
geom_point(size=8)+
geom_errorbar(aes(ymin=(eclosion_date-se), ymax=(eclosion_date+se), size=3.5))+
ylab("Development time (days)")+
xlab("Sex")+
theme_bw()+
theme(axis.text = element_text(size=30),
axis.title.x = element_text(size=45), axis.title.y = element_text(size=45), legend.position = "none",strip.text=element_text(size=30))+
theme(axis.title.x = element_text(vjust=-0.4), axis.title.y = element_text(vjus =2.5, hjust = 0.5))+
theme(plot.margin = unit(c(0.5,0.1,0.7,0.7), "cm"))+
scale_colour_manual(values=c("#E69F00", "#009E73"))+
facet_wrap(~chro,scales="free_x")
dev.time.sex
ggsave("Plots/development_time_sex_point_plot.png")
# packages needed
library(survival)
cite(survival)
cite(survival)
citation(survival)
citation("survival")
library(survminer)
citation("survminer")
citation()
#### read manually prepeared dta and check ####
setwd("/Users/michaeljardine/Desktop/DTP/Data and analysis/fruitless/ageing")
# packages needed
library(survival)
library(plyr)
library(survminer)
library(RColorBrewer)
library(ggsci)
agefru <- read.csv("ageing.manual.csv")
summary(agefru)
str(agefru)
agefru$allele.chro <- interaction(agefru$allele, agefru$chro)
agefru$allele.sex <- interaction(agefru$allele, agefru$sex)
agefru$chro.sex <- interaction(agefru$chro, agefru$sex)
str(agefru)
## all flies
surv.total.allele.only <- coxph(Surv(day, censor) ~ allele, data=agefru)
surv.total.allele.only
summary(surv.total.allele.only)
anova(surv.total.allele.only)
## B flies
B.surv.allele.only <- coxph(Surv(day, censor) ~ allele, data=agefruB)
B.surv.allele.only
summary(B.surv.allele.only)
anova(B.surv.allele.only)
agefruB
View(agefruB)
# split them up
chrosex_split <- split(agefruD, agefruD$sex)
agefruDF <- chrosex_split[[1]]
agefruDM <- chrosex_split[[2]]
chroBsex_split <- split(agefruB, agefruB$sex)
agefruBF <- chroBsex_split[[1]]
agefruBM <- chroBsex_split[[2]]
View(agefruBF)
DF.surv <- coxph(Surv(day, censor) ~ allele, data=agefruDF)
DM.surv <- coxph(Surv(day, censor) ~ allele, data=agefruDM)
BF.surv <- coxph(Surv(day, censor) ~ allele, data=agefruBF)
BM.surv <- coxph(Surv(day, censor) ~ allele, data=agefruBM)
## B females flies
surv.total.allele.only
summary(surv.total.allele.only)
anova(surv.total.allele.only)
## B females flies
BF.surv
summary(BF.surv)
anova(BF.surv)
## all by sex
surv.total.sex.only <- coxph(Surv(day, censor) ~ sex, data=agefru)
surv.total.sex.only
summary(surv.total.sex.only)
anova(surv.total.sex.only)
## all by complement
surv.total.chro.only <- coxph(Surv(day, censor) ~ chro, data=agefru)
surv.total.chro.only
summary(surv.total.chro.only)
anova(surv.total.chro.only)
DF.surv <- coxph(Surv(day, censor) ~ allele, data=agefruDF)
DM.surv <- coxph(Surv(day, censor) ~ allele, data=agefruDM)
BF.surv <- coxph(Surv(day, censor) ~ allele, data=agefruBF)
BM.surv <- coxph(Surv(day, censor) ~ allele, data=agefruBM)
## B females flies
BF.surv
summary(BF.surv)
anova(BF.surv)
# MODEL OUPUT
# D females
summary(DF.surv)
# D males
summary(DM.surv)
# B females
summary(BF.surv)
# B males
summary(BM.surv)
### COMPARE THE TWO MODELS
AIC(TLMM2, TSQLMM2)
setwd("/Users/michaeljardine/Desktop/DTP/Data and analysis/fruitless/Eggs")
Teggs <- read.csv("All_egg_counts_blocks_1-3.csv")
str(Teggs)
### convert line to a factor with 6 levels
Teggs$line <- factor(Teggs$line)
str(Teggs)
### convert block to factor
Teggs$block <- factor(Teggs$block)
str(Teggs)
summary(Teggs)
### convert M and F alleles to long and short ( L and S) respectively
levels(Teggs$allele) <- c("S", "L")
### we have two numbers produced for the number eggs, predicted and corrected
x = eggs2$Predicted.count.
y = eggs2$Corrected.count.
cor(x, y)
par(mfrow=c(3,1))
hist(Teggs$Predicted.count.)
### bunched mostly towards zero try logging?
hist(log(Teggs$Predicted.count.))
### dosen't really help, now bunched towards the right - square rooting?
hist(sqrt(Teggs$Predicted.count.))
# some summary statistics for means and errors
summarySE(Teggs, measurevar=c("Predicted.count."), groupvars=c("allele"))
summarySE(Teggs, measurevar=c("Predicted.count."), groupvars=c("line"))
summarySE(Teggs, measurevar=c("Predicted.count."), groupvars=c("genotype"))
summarySE(Teggs, measurevar=c("Predicted.count."), groupvars=c("block"))
### later models will have an intercation between allele and genotype so we will get summary stats for this too
Teggs$allelegenotype <- interaction(Teggs$allele, Teggs$genotype)
summarySE(Teggs, measurevar=c("Predicted.count."), groupvars=c("allelegenotype"))
Teggs$linegenotype <- interaction(Teggs$line, Teggs$genotype)
Teggs$BLG <- interaction(Teggs$linegenotype, Teggs$block)
summarySE(Teggs, measurevar=c("Predicted.count."), groupvars=c("BLG"))
summarySE(Teggs, measurevar=c("Predicted.count."), groupvars=c("linegenotype"))
Teggs$blockline <- interaction(Teggs$line, Teggs$block)
summarySE(Teggs, measurevar=c("Predicted.count."), groupvars=c("blockline"))
TLMM1 <- lmer(Predicted.count. ~ allele + (1 | line) + (1 | block), data=Teggs)
res <- resid(TLMM1)
ran <- ranef(TLMM1)
fit <- fitted(TLMM1)
par(mfrow=c(1,3))
hist(ran$line[,1], main='')
plot(res ~ fit)
qqnorm(res, main='')
qqline(res)
summary(TLMM1)
anova(TLMM1)
Anova(TLMM1)
TSQLMM1 <- lmer(sqrt(Predicted.count.) ~ allele + (1 | line) + (1 | block), data=Teggs)
res <- resid(TSQLMM1)
ran <- ranef(TSQLMM1)
fit <- fitted(TSQLMM1)
par(mfrow=c(1,3))
hist(ran$line[,1], main='')
plot(res ~ fit)
qqnorm(res, main='')
qqline(res)
summary(TSQLMM1)
anova(TSQLMM1)
Anova(TSQLMM1)
### looks the smae really
AIC(TLMM1, TSQLMM1)
anova(TLMM1, TSQLMM1)
TLMM2 <- lmer(Predicted.count. ~ allele*genotype + (1 | line) + (1 | block), data=Teggs)
res <- resid(TLMM2)
ran <- ranef(TLMM2)
fit <- fitted(TLMM2)
par(mfrow=c(1,3))
hist(ran$line[,1], main='')
plot(res ~ fit)
qqnorm(res, main='')
par(mfrow=c(1,4))
hist(ran$line[,1], main='')
hist(ran$line[,2], main='')
hist(ran$block[,1], main='')
plot(res ~ fit)
qqnorm(res, main='')
qqline(res)
TSQLMM2 <- lmer(sqrt(Predicted.count.) ~ allele*genotype + (1 | line) + (1 | block), data=Teggs)
res <- resid(TSQLMM2)
ran <- ranef(TSQLMM2)
fit <- fitted(TSQLMM2)
par(mfrow=c(1,4))
hist(ran$line[,1], main='')
hist(ran$block[,1], main='')
plot(res ~ fit)
qqnorm(res, main='')
qqline(res)
summary(TSQLMM2)
anova(TSQLMM2)
Anova(TSQLMM2)
2
### COMPARE THE TWO MODELS
AIC(TLMM2, TSQLMM2)
anova(TLMM2, TSQLMM2)
Egg.GLMM <- glmer(Predicted.count. ~ allele*genotype + (1 | line) + (1 | block), data=Teggs, family=poisson(link=log))
res <- resid(Egg.GLMM)
ran <- ranef(Egg.GLMM)
fit <- fitted(Egg.GLMM)
par(mfrow=c(1,4))
hist(ran$line[,1], main='')
hist(ran$block[,1], main='')
plot(res ~ fit)
qqnorm(res, main='')
qqline(res)
summary(Egg.GLMM)
anova(Egg.GLMM)
Anova(Egg.GLMM)
AIC(TSQLMM2, Egg.GLMM)
anova(TSQLMM2, Egg.GLMM)
View(Teggs)
