setwd("/Users/michaeljardine/Desktop/DTP/Data and analysis/Eggs")
eggcomp <- read.csv("eggs_comp_comparison.csv")
str(eggcomp)
## change block to a factor
eggcomp$block <- factor(eggcomp$block)
str(eggcomp)
library(ggplot2)
## PACKAGES
library(Rmisc)
library(lme4)
library(aod)
library(pbkrtest)
library(car)
cbpallete <- c("darkblue", "royalblue", "skyblue2", "firebrick3", "red", "tomato")
### eggs by comp for each line only
compegg <- ggplot(aes(y=eggs, x=comp, color=line), data=eggcomp)+
geom_point(aes(size=3))+
geom_smooth(method=lm, formula = y~x, se=FALSE, fullrange=TRUE, size=2)+
ylab("Number of eggs laid")+
xlab("Proporion of matings by focal males")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=25))+
scale_y_continuous(limits=c(0, 60))+
scale_x_continuous(limits=c(0, 1))+
scale_colour_manual(values=cbpallete)+
theme(legend.position="right")
compegg
### eggs by comp, lines for each allele
cbpallete2 <- c("royalblue",  "red")
compegg1.1 <- ggplot(aes(y=eggs, x=comp, color=allele), data=eggcomp)+
geom_point(aes(size=3))+
geom_smooth(method=lm, formula = y~x, se=FALSE, fullrange=TRUE, size=2)+
ylab("Number of eggs laid")+
xlab("Proporion of matings by focal males")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=25))+
scale_y_continuous(limits=c(0, 60))+
scale_x_continuous(limits=c(0, 1))+
scale_colour_manual(values=cbpallete2)+
theme(legend.position="right")
compegg1.1
### attempt to shape by block,
compegg2 <- ggplot(aes(y=eggs, x=comp, color=line, shape=block), data=eggcomp)+
geom_point(aes(size=3))+
geom_smooth(method=lm, formula = y~x, se=FALSE, fullrange=TRUE, size=2)+
ylab("Number of eggs laid")+
xlab("Proporion of matings by focal males")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=25))+
scale_y_continuous(limits=c(0, 60))+
theme(legend.position="right")
compegg2
### simple eggs b comp all together
compegg3 <- ggplot(aes(y=eggs, x=comp), data=eggcomp)+
geom_point(aes(size=3))+
geom_smooth(method=lm, formula = y~x, se=FALSE, fullrange=TRUE, size=2)+
ylab("Number of eggs laid")+
xlab("Proporion of matings by focal males")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=25))+
scale_y_continuous(limits=c(0, 60))+
scale_x_continuous(limits=c(0, 1))+
theme(legend.position="right")
compegg3
### simple first
compegg3 <- ggplot(aes(y=eggs, x=comp), data=eggcomp)+
geom_point(aes(size=3))+
geom_smooth(method=lm, formula = y~x, se=FALSE, fullrange=TRUE, size=2)+
ylab("Number of eggs laid")+
xlab("Proporion of matings by focal males")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=25))+
scale_y_continuous(limits=c(0, 60))+
scale_x_continuous(limits=c(0, 1))+
theme(legend.position="right")+
facet_wrap(~chro,scales="free_x")
compegg3
## for B =
Bline <- eggcomp[which(eggcomp$chro=="B"),]
x=Bline$comp
y=Bline$eggs
cor(x,y)
## for D =
Dline <- eggcomp[which(eggcomp$chro=="D"),]
x=Dline$comp
y=Dline$eggs
cor(x,y)
### colour plots by line as in the first plot
compegg5 <- ggplot(aes(y=eggs, x=comp, color=line), data=eggcomp)+
geom_point(aes(size=3))+
geom_smooth(method=lm, formula = y~x, se=FALSE, fullrange=TRUE, size=2)+
ylab("Number of eggs laid")+
xlab("Proporion of matings by focal males")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=25))+
scale_y_continuous(limits=c(0, 60))+
scale_x_continuous(limits=c(0, 1))+
theme(legend.position="right")+
facet_wrap(~chro,scales="free_x")
compegg5
compegg1.1 <- ggplot(aes(y=eggs, x=comp, color=allele), data=eggcomp)+
geom_point(aes(size=3))+
geom_smooth(method=lm, formula = y~x, se=FALSE, fullrange=TRUE, size=2)+
ylab("Number of eggs laid")+
xlab("Proporion of matings by focal males")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=25))+
scale_y_continuous(limits=c(0, 50))+
scale_x_continuous(limits=c(0, 1))+
scale_colour_manual(values=cbpallete2)+
theme(legend.position="right")
compegg1.1
compegg1.1 <- ggplot(aes(y=eggs, x=comp, color=allele), data=eggcomp)+
geom_point(aes(size=3))+
geom_smooth(method=lm, formula = y~x, se=FALSE, fullrange=TRUE, size=2)+
ylab("Number of eggs laid")+
xlab("Proporion of matings by focal males")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=25))+
scale_y_continuous(limits=c(0, 60))+
scale_x_continuous(limits=c(0, 1))+
scale_colour_manual(values=cbpallete2)+
theme(legend.position="right")
compegg1.1
compegg1.1 <- ggplot(aes(y=eggs, x=comp, color=allele), data=eggcomp)+
geom_point(aes(size=3))+
geom_smooth(method=lm, formula = y~x, se=FALSE, fullrange=TRUE, size=2)+
ylab("Number of eggs laid")+
xlab("Proporion of matings by focal males")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=25))+
scale_y_continuous(limits=c(5, 50))+
scale_x_continuous(limits=c(0, 1))+
scale_colour_manual(values=cbpallete2)+
theme(legend.position="right")
compegg1.1
compegg1.1 <- ggplot(aes(y=eggs, x=comp, color=allele), data=eggcomp)+
geom_point(aes(size=3))+
geom_smooth(method=lm, formula = y~x, se=FALSE, fullrange=TRUE, size=2)+
ylab("Number of eggs laid")+
xlab("Proporion of matings by focal males")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=25))+
scale_y_continuous(limits=c(0, 60))+
scale_x_continuous(limits=c(0, 1))+
scale_colour_manual(values=cbpallete2)+
theme(legend.position="right")
compegg1.1
### simple eggs b comp all together
compegg3 <- ggplot(aes(y=eggs, x=comp), data=eggcomp)+
geom_point(aes(size=3))+
geom_smooth(method=lm, formula = y~x, se=FALSE, fullrange=TRUE, size=2)+
ylab("Number of eggs laid")+
xlab("Proporion of matings by focal males")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=25))+
scale_y_continuous(limits=c(0, 60))+
scale_x_continuous(limits=c(0, 1))+
theme(legend.position="right")
compegg3
### simple eggs b comp all together
compegg3 <- ggplot(aes(y=eggs, x=comp), data=eggcomp)+
geom_point(aes(size=3))+
geom_smooth(method=lm, formula = y~x, se=FALSE, fullrange=TRUE, size=2)+
ylab("Number of eggs laid")+
xlab("Proporion of matings by focal males")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=25))+
scale_y_continuous(limits=c(0, 50))+
scale_x_continuous(limits=c(0, 1))+
theme(legend.position="right")
compegg3
### simple eggs b comp all together
compegg3 <- ggplot(aes(y=eggs, x=comp), data=eggcomp)+
geom_point(aes(size=3))+
geom_smooth(method=lm, formula = y~x, se=FALSE, fullrange=TRUE, size=2)+
ylab("Number of eggs laid")+
xlab("Proporion of matings by focal males")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=25))+
scale_y_continuous(limits=c(0, 60))+
scale_x_continuous(limits=c(0, 1))+
theme(legend.position="right")
compegg3
## could also repeat this for different chro
compegg1.2 <- ggplot(aes(y=eggs, x=comp, color=allele), data=eggcomp)+
geom_point(aes(size=3))+
geom_smooth(method=lm, formula = y~x, se=FALSE, fullrange=TRUE, size=2)+
ylab("Number of eggs laid")+
xlab("Proporion of matings by focal males")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=25))+
scale_y_continuous(limits=c(0, 60))+
scale_x_continuous(limits=c(0, 1))+
scale_colour_manual(values=cbpallete2)+
theme(legend.position="right")+
facet_wrap(~chro,scales="free_x")
compegg1.2
Teggs <- read.csv("All_egg_counts_blocks_1-3.csv")
str(Teggs)
setwd("/Users/michaeljardine/Desktop/DTP/Data and analysis/Eggs")
eggcomp <- read.csv("eggs_comp_comparison.csv")
str(eggcomp)
## change block to a factor
eggcomp$block <- factor(eggcomp$block)
str(eggcomp)
cbpallete <- c("darkblue", "royalblue", "skyblue2", "firebrick3", "red", "tomato")
### eggs by comp, lines for each allele
cbpallete2 <- c("royalblue",  "red")
compegg1.1 <- ggplot(aes(y=eggs, x=comp, color=allele), data=eggcomp)+
geom_point(aes(size=3))+
geom_smooth(method=lm, formula = y~x, se=FALSE, fullrange=TRUE, size=2)+
ylab("Number of eggs laid")+
xlab("Proporion of matings by focal males")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=25))+
scale_y_continuous(limits=c(0, 60))+
scale_x_continuous(limits=c(0, 1))+
scale_colour_manual(values=cbpallete2)+
theme(legend.position="right")
compegg1.1
### caluclate the slopes of these lines
# L flies =
Lline <- eggcomp[which(eggcomp$allele=="L"),]
x=Lline$comp
y=Lline$eggs
cor(x, y)
# S flies =
Sline <- eggcomp[which(eggcomp$allele=="S"),]
x=Sline$comp
y=Sline$eggs
cor(x, y)
## could also repeat this for different chro
compegg1.2 <- ggplot(aes(y=eggs, x=comp, color=allele), data=eggcomp)+
geom_point(aes(size=3))+
geom_smooth(method=lm, formula = y~x, se=FALSE, fullrange=TRUE, size=2)+
ylab("Number of eggs laid")+
xlab("Proporion of matings by focal males")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=25))+
scale_y_continuous(limits=c(0, 60))+
scale_x_continuous(limits=c(0, 1))+
scale_colour_manual(values=cbpallete2)+
theme(legend.position="right")+
facet_wrap(~chro,scales="free_x")
### simple first
compegg4 <- ggplot(aes(y=eggs, x=comp), data=eggcomp)+
geom_point(aes(size=3))+
geom_smooth(method=lm, formula = y~x, se=FALSE, fullrange=TRUE, size=2)+
ylab("Number of eggs laid")+
xlab("Proporion of matings by focal males")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=25))+
scale_y_continuous(limits=c(0, 60))+
scale_x_continuous(limits=c(0, 1))+
theme(legend.position="right")+
facet_wrap(~chro,scales="free_x")
compegg4
### colour plots by line as in the first plot
compegg5 <- ggplot(aes(y=eggs, x=comp, color=line), data=eggcomp)+
geom_point(aes(size=3))+
geom_smooth(method=lm, formula = y~x, se=FALSE, fullrange=TRUE, size=2)+
ylab("Number of eggs laid")+
xlab("Proporion of matings by focal males")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=25))+
scale_y_continuous(limits=c(0, 60))+
scale_x_continuous(limits=c(0, 1))+
theme(legend.position="right")+
facet_wrap(~chro,scales="free_x")
compegg5
### simple eggs b comp all together
compegg3 <- ggplot(aes(y=eggs, x=comp), data=eggcomp)+
geom_point(aes(size=3))+
geom_smooth(method=lm, formula = y~x, se=FALSE, fullrange=TRUE, size=2)+
ylab("Number of eggs laid")+
xlab("Proporion of matings by focal males")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=25))+
scale_y_continuous(limits=c(0, 60))+
scale_x_continuous(limits=c(0, 1))+
theme(legend.position="right")
compegg3
## could also repeat this for different chro
compegg1.2 <- ggplot(aes(y=eggs, x=comp, color=allele), data=eggcomp)+
geom_point(aes(size=3))+
geom_smooth(method=lm, formula = y~x, se=FALSE, fullrange=TRUE, size=2)+
ylab("Number of eggs laid")+
xlab("Proporion of matings by focal males")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=25))+
scale_y_continuous(limits=c(0, 60))+
scale_x_continuous(limits=c(0, 1))+
scale_colour_manual(values=cbpallete2)+
theme(legend.position="right")+
facet_wrap(~chro,scales="free_x")
compegg1.2
setwd("/Users/michaeljardine/Desktop/DTP/Data and analysis/Eggs")
Teggs <- read.csv("All_egg_counts_blocks_1-3.csv")
str(Teggs)
### convert line to a factor with 6 levels
Teggs$line <- factor(Teggs$line)
str(Teggs)
### convert block to factor
Teggs$block <- factor(Teggs$block)
str(Teggs)
summary(Teggs)
### convert M and F alleles to long and short ( L and S) respectively
levels(Teggs$allele) <- c("S", "L")
### we have two numbers produced for the number eggs, predicted and corrected
x = eggs2$Predicted.count.
y = eggs2$Corrected.count.
summary(Teggs)
### set working directory
setwd("/Users/michaeljardine/Desktop/DTP/Data and analysis/Malecomp")
Tcomp <- read.csv("ALL_3_BLOCKS_ALT.csv")
summary(Tcomp)
str(Tcomp)
## change Line to a factor
Tcomp$Line <- factor(Tcomp$Line)
## change Round to a factor
Tcomp$Round <- factor(Tcomp$Round)
## change Block to a factor
Tcomp$Block <- factor(Tcomp$Block)
str(Tcomp)
## remove NA
Tcomp <- na.omit(Tcomp)
str(Tcomp)
summary(Tcomp)
### change alleles fom M and F to S (short) and L (long)
levels(Tcomp$Allele) <- c("S", "L")
## change pupa to a 1/0 score to see who the winner is
Tcomp$winner <- ifelse(Tcomp$Pupa %in% c("T"), 0, 1)
## winner: competitor = 0 (Tub), focal = 1 (Norm)
str(Tcomp)
summary(Tcomp)
## combine the line and the genotype to create 5B/5D, 8B/8D etc - this is for the plots later on
Tcomp$Linegenotype <- interaction(Tcomp$Line, Tcomp$Genotype)
library(lme4)
citation(lme4)
citation("lme4")
citation("pbkrtest")
### set working directory
setwd("/Users/michaeljardine/Desktop/DTP/Data and analysis/fruitless/Malecomp")
## PACKAGES
library(Rmisc)
library(lme4)
library(aod)
library(lsmeans)
library(ggplot2)
library(pbkrtest)
library(car)
Tcomp <- read.csv("ALL_3_BLOCKS_ALT.csv")
summary(Tcomp)
str(Tcomp)
## change Line to a factor
Tcomp$Line <- factor(Tcomp$Line)
## change Round to a factor
Tcomp$Round <- factor(Tcomp$Round)
## change Block to a factor
Tcomp$Block <- factor(Tcomp$Block)
str(Tcomp)
## remove NA
Tcomp <- na.omit(Tcomp)
str(Tcomp)
summary(Tcomp)
### change alleles fom M and F to S (short) and L (long)
levels(Tcomp$Allele) <- c("S", "L")
## change pupa to a 1/0 score to see who the winner is
Tcomp$winner <- ifelse(Tcomp$Pupa %in% c("T"), 0, 1)
## winner: competitor = 0 (Tub), focal = 1 (Norm)
str(Tcomp)
summary(Tcomp)
## combine the line and the genotype to create 5B/5D, 8B/8D etc - this is for the plots later on
Tcomp$Linegenotype <- interaction(Tcomp$Line, Tcomp$Genotype)
str(Tcomp)
## combine for genotype with introgressed part
Tcomp$Allelegenotype <- interaction(Tcomp$Allele, Tcomp$Genotype)
Tcomp$Lineblock <- interaction(Tcomp$Line, Tcomp$Block)
str(Tcomp)
Tcomp$linegenotype <- interaction(Tcomp$Line, Tcomp$Genotype)
Tcomp$BLG <- interaction(Tcomp$linegenotype, Tcomp$Block)
summarySE(Tcomp, measurevar=c("winner"), groupvars=c("BLG"))
TGLMM1.1 <- glmer(winner ~ Allele + (1 | Line) + (1 | Block) + (1 | Round), data=Tcomp, family=binomial(link=logit))
res <- resid(TGLMM1.1)
ran <- ranef(TGLMM1.1)
fit <- fitted(TGLMM1.1)
par(mfrow=c(1,5))
hist(ran$Line[,1], main='')
hist(ran$Round[,1], main='')
hist(ran$Block[,1], main='')
plot(res ~ fit)
qqnorm(res, main='')
qqline(res)
summary(TGLMM1.1)
anova(TGLMM1.1)
Anova(TGLMM1.1)
### the flies differ in their genotype (B or D) so we will inclide this in the model also to account for this variation
### keep the simple random effect for now
GLMM2.1 <- glmer(winner ~ Allele*Genotype +  (1 | Line) + (1 | Block) + (1 | Round), data=Tcomp, family=binomial(link=logit))
res <- resid(GLMM2.1)
ran <- ranef(GLMM2.1)
fit <- fitted(GLMM2.1)
par(mfrow=c(1,5))
hist(ran$Line[,1], main='')
hist(ran$Round[,1], main='')
hist(ran$Block[,1], main='')
plot(res ~ fit)
qqnorm(res, main='')
qqline(res)
summary(GLMM2.1)
anova(GLMM2.1)
Anova(GLMM2.1)
GLMM2.3 <- glmer(winner ~ Allele*Genotype +  (1 + Allele | Line) + (1 | Block) + (1 | Round), data=Tcomp, family=binomial(link=logit))
### warning messages but still works
res <- resid(GLMM2.3)
ran <- ranef(GLMM2.3)
fit <- fitted(GLMM2.3)
par(mfrow=c(1,5))
hist(ran$Line[,1], main='')
hist(ran$Round[,1], main='')
hist(ran$Block[,1], main='')
plot(res ~ fit)
qqnorm(res, main='')
qqline(res)
summary(GLMM2.3)
anova(GLMM2.3)
Anova(GLMM2.3)
## very simialr results but with error messages on the model
anova(GLMM2.1, GLMM2.3)
comp1 <- glmer(winner ~ 1 +  (1 | Line) + (1 | Block) + (1 | Round), data=Tcomp, family=binomial(link=logit))
comp2 <- glmer(winner ~ Allele +  (1 | Line) + (1 | Block) + (1 | Round), data=Tcomp, family=binomial(link=logit))
comp3 <- glmer(winner ~ Genotype +  (1 | Line) + (1 | Block) + (1 | Round), data=Tcomp, family=binomial(link=logit))
comp4 <- glmer(winner ~ Allele + Genotype +  (1 | Line) + (1 | Block) + (1 | Round), data=Tcomp, family=binomial(link=logit))
comp5 <- glmer(winner ~ Allele*Genotype +  (1 | Line) + (1 | Block) + (1 | Round), data=Tcomp, family=binomial(link=logit))
MC.allele <- PBmodcomp(comp4, comp3, nsim=1000)
MC.allele
MC.chro <- PBmodcomp(comp4, comp2, nsim=1000)
MC.chro
MC.inter <- PBmodcomp(comp5, comp4, nsim=1000)
MC.inter
MC.inter <- PBmodcomp(comp5, comp4, nsim=1000)
MC.inter
