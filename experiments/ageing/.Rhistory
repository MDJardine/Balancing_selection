S.Curve.total.Sex<- ggsurvplot(fit.total.sex, data=agefru, pval=T, palette = c('#e69f00', '#009e73'),
xlab="Time in days", censor.size=2, size=1.5, font.x=c(14, "bold"), font.y=c(14, "bold"),
font.tickslab=c(12), legend.labs=c("Female", "Male"))
S.Curve.total.Sex
S.Curve.total.Sex<- ggsurvplot(fit.total.sex, data=agefru, pval=T, palette = c('#e69f00', '#009e73'),
xlab="Time in days", censor.size=2.5, size=1.5, font.x=c(14, "bold"), font.y=c(14, "bold"),
font.tickslab=c(12), legend.labs=c("Female", "Male"))
S.Curve.total.Sex
S.Curve.total.Sex<- ggsurvplot(fit.total.sex, data=agefru, pval=T, palette = c('#e69f00', '#009e73'),
xlab="Time in days", censor.size=2.5, size=1.25, font.x=c(14, "bold"), font.y=c(14, "bold"),
font.tickslab=c(12), legend.labs=c("Female", "Male"))
S.Curve.total.Sex
S.Curve.total.Sex<- ggsurvplot(fit.total.sex, data=agefru, pval=T, palette = c('#e69f00', '#009e73'),
xlab="Time in days", censor.size=5, size=1.25, font.x=c(14, "bold"), font.y=c(14, "bold"),
font.tickslab=c(12), legend.labs=c("Female", "Male"))
S.Curve.total.Sex
S.Curve.total.Sex<- ggsurvplot(fit.total.sex, data=agefru, pval=T, palette = c('#e69f00', '#009e73'),
xlab="Time in days", censor.size=6, size=1.25, font.x=c(14, "bold"), font.y=c(14, "bold"),
font.tickslab=c(12), legend.labs=c("Female", "Male"))
S.Curve.total.Sex
## work by creating a survival object for each factor and then plotting it
## Sex
fit.total.sex <- survfit(Surv(day, censor) ~ sex, data=agefru)
S.Curve.total.Sex<- ggsurvplot(fit.total.sex, data=agefru, pval=T, palette = c('#e69f00', '#009e73'),
xlab="Time in days", censor.size=6, size=1.25, font.x=c(14, "bold"), font.y=c(14, "bold"),
font.tickslab=c(12), legend.labs=c("Female", "Male"))
S.Curve.total.Sex
ggsave("Plots/Survival_curve_total_sex.png")
##allele
fit.total.allele <- survfit(Surv(day, censor) ~ allele, data=agefru)
S.curv.total.allele <- ggsurvplot(fit.total.allele, data=agefru, pval=T, palette = c('#ca3542', '#7a8ed9'),
xlab="Time in days", censor.size=6, size=1.25, font.x=c(14, "bold"), font.y=c(14, "bold"),
font.tickslab=c(12), legend.labs=c("L", "S"))
S.curv.total.allele
ggsave("Plots/Survival_curve_total_allele.png")
##chro
fit.total.chro <- survfit(Surv(day, censor) ~ chro, data=agefru)
S.curv.total.chro <- ggsurvplot(fit.total.chro, data=agefru, pval=T, palette = c('#ffd24d', '#b06bc7'),
xlab="Time in days", censor.size=6, size=1.25, font.x=c(14, "bold"), font.y=c(14, "bold"),
font.tickslab=c(12), legend.labs=c("Balancer", "Deletion"))
S.curv.total.chro
ggsave("Plots/Survival_curve_total_chro.png")
## allele x chro
fit.total.A.C <- survfit(Surv(day, censor) ~ allele.chro, data=agefru)
S.curv.total.AxC <- ggsurvplot(fit.total.A.C, data=agefru, pval=T, palette = c('jama'),
xlab="Time in days", censor.size=6, size=1.25, font.x=c(14, "bold"), font.y=c(14, "bold"),
font.tickslab=c(12), legend.labs=c("L allele balancer", "L allele deletion", "S allele balancer", 'S allele deletion'))
## allele x chro
fit.total.A.C <- survfit(Surv(day, censor) ~ allele.chro, data=agefru)
agefru$allele.chro <- interaction(agefru$allele, agefru$chro)
agefru$allele.sex <- interaction(agefru$allele, agefru$sex)
agefru$chro.sex <- interaction(agefru$chro, agefru$sex)
str(agefru)
## allele x chro
fit.total.A.C <- survfit(Surv(day, censor) ~ allele.chro, data=agefru)
S.curv.total.AxC <- ggsurvplot(fit.total.A.C, data=agefru, pval=T, palette = c('jama'),
xlab="Time in days", censor.size=6, size=1.25, font.x=c(14, "bold"), font.y=c(14, "bold"),
font.tickslab=c(12), legend.labs=c("L allele balancer", "L allele deletion", "S allele balancer", 'S allele deletion'))
S.curv.total.AxC
ggsave("Plots/Survival_curve_total_allelexchro.png")
## allele x sex
fit.total.A.S<- survfit(Surv(day, censor) ~ allele.sex, data=agefru)
S.curv.total.AxS <- ggsurvplot(fit.total.A.S, data=agefru, pval=T, palette = c('jama'),
xlab="Time in days", censor.size=6, size=1.25, font.x=c(14, "bold"), font.y=c(14, "bold"),
font.tickslab=c(12), legend.labs=c("L allele females", "L allele males", "S alelle females", "S allele males"))
S.curv.total.AxS
ggsave("Plots/Survival_curve_total_allelexsex.png")
## chro x sex
fit.total.C.S <- survfit(Surv(day, censor) ~ chro.sex, data=agefru)
S.curv.total.CxS <- ggsurvplot(fit.total.C.S, data=agefru, pval=T, palette = c('jama'),
xlab="Time in days", censor.size=6, size=1.25, font.x=c(14, "bold"), font.y=c(14, "bold"),
font.tickslab=c(12), legend.labs=c("Female balancer", "Male balancer", "Female deletion", "Male deletion"))
S.curv.total.CxS
ggsave("Plots/Survival_curve_total_chroxsex.png")
####  D flies plots #####
# sex
fit.D.sex <- survfit(Surv(day, censor) ~ sex, data=agefruD)
S.Curve.D.Sex<- ggsurvplot(fit.D.sex, data=agefruD, pval=T, palette = c('#e69f00', '#009e73'),
xlab="Time in days", censor.size=6, size=1.25, font.x=c(14, "bold"), font.y=c(14, "bold"),
font.tickslab=c(12), legend.labs=c("Female", "Male"))
S.Curve.D.Sex
ggsave("Plots/Survival_curve_D_sex.png")
# allele
fit.D.allele <- survfit(Surv(day, censor) ~ allele, data=agefruD)
S.curv.D.allele <- ggsurvplot(fit.D.allele, data=agefruD, pval=T, palette = c('#ca3542', '#7a8ed9'),
xlab="Time in days", censor.size=6, size=1.25, font.x=c(14, "bold"), font.y=c(14, "bold"),
font.tickslab=c(12), legend.labs=c("L allele", "S allele"))
S.curv.D.allele
ggsave("Plots/Survival_curve_D_allele.png")
# allele x sex
fit.D.A.S<- survfit(Surv(day, censor) ~ allele.sex, data=agefruD)
S.curv.D.AxS <- ggsurvplot(fit.D.A.S, data=agefruD, pval=T, palette = 'jama',
xlab="Time in days", censor.size=6, size=1.25, font.x=c(14, "bold"), font.y=c(14, "bold"),
font.tickslab=c(12), legend.labs=c("L allele females", "L allele males", "S alelle females", "S allele males"))
## as before the effect fo the chro comp seesm to confuse and outeay the results
## split by chro and see
chro_split <- split(agefru, agefru$chro)
agefruB <- chro_split[[1]]
agefruD <- chro_split[[2]]
#### also split by sex
sex_split <- split(agefru, agefru$sex)
agefruF <- sex_split[[1]]
agefruM <- sex_split[[2]]
# allele x sex
fit.D.A.S<- survfit(Surv(day, censor) ~ allele.sex, data=agefruD)
S.curv.D.AxS <- ggsurvplot(fit.D.A.S, data=agefruD, pval=T, palette = 'jama',
xlab="Time in days", censor.size=6, size=1.25, font.x=c(14, "bold"), font.y=c(14, "bold"),
font.tickslab=c(12), legend.labs=c("L allele females", "L allele males", "S alelle females", "S allele males"))
S.curv.D.AxS
ggsave("Plots/Survival_curve_D_allelexsex.png")
####  B flies plots #####
# sex
fit.B.sex <- survfit(Surv(day, censor) ~ sex, data=fruageB)
S.Curve.B.Sex<- ggsurvplot(fit.B.sex, data=fruageB, pval=T, palette = c('#e69f00', '#009e73'),
xlab="Time in days", censor.size=6, size=1.25, font.x=c(14, "bold"), font.y=c(14, "bold"),
font.tickslab=c(12), legend.labs=c("Female", "Male"))
S.Curve.B.Sex
####  B flies plots #####
# sex
fit.B.sex <- survfit(Surv(day, censor) ~ sex, data=agefruB)
S.Curve.B.Sex<- ggsurvplot(fit.B.sex, data=agefruB, pval=T, palette = c('#e69f00', '#009e73'),
xlab="Time in days", censor.size=6, size=1.25, font.x=c(14, "bold"), font.y=c(14, "bold"),
font.tickslab=c(12), legend.labs=c("Female", "Male"))
S.Curve.B.Sex
ggsave("Plots/Survival_curve_B_sex.png")
# allele
fit.B.allele <- survfit(Surv(day, censor) ~ allele, data=agefruB)
S.curv.B.allele <- ggsurvplot(fit.B.allele, data=agefruB, pval=T, palette = c('#ca3542', '#7a8ed9'),
xlab="Time in days", censor.size=6, size=1.25, font.x=c(14, "bold"), font.y=c(14, "bold"),
font.tickslab=c(12), legend.labs=c("L allele", "S allele"))
S.curv.B.allele
S.Curve.B.Sex<- ggsurvplot(fit.B.sex, data=agefruB, pval=T, palette = c('#e69f00', '#009e73'),
xlab="Time in days", censor.size=6, size=1.25, font.x=c(14, "bold"), font.y=c(14, "bold"),
font.tickslab=c(12), xlim=c(0,100), break.x.by=25, legend.labs=c("Female", "Male"))
S.Curve.B.Sex
ggsave("Plots/Survival_curve_B_sex.png")
# allele
fit.B.allele <- survfit(Surv(day, censor) ~ allele, data=agefruB)
S.curv.B.allele <- ggsurvplot(fit.B.allele, data=agefruB, pval=T, palette = c('#ca3542', '#7a8ed9'),
xlab="Time in days", censor.size=6, size=1.25, font.x=c(14, "bold"), font.y=c(14, "bold"),
font.tickslab=c(12), xlim=c(0,100), break.x.by=25, legend.labs=c("L allele", "S allele"))
S.curv.B.allele
ggsave("Plots/Survival_curve_B_allele.png")
# allele x sex
fit.B.A.S<- survfit(Surv(day, censor) ~ allele.sex, data=agefruB)
S.curv.B.AxS <- ggsurvplot(fit.B.A.S, data=agefruB, pval=T, palette = 'jama',
xlab="Time in days", censor.size=6, size=1.25, font.x=c(14, "bold"), font.y=c(14, "bold"),
font.tickslab=c(12), xlim=c(0,100), break.x.by=25, legend.labs=c("L allele females", "L allele males", "S alelle females", "S allele males"))
S.curv.B.AxS
ggsave("Plots/Survival_curve_B_allelexsex.png")
##allele
fit.M.allele <- survfit(Surv(day, censor) ~ allele, data=agefruM)
S.curv.M.allele <- ggsurvplot(fit.M.allele, data=agefruM, pval=T, palette = c('#ca3542', '#7a8ed9'),
xlab="Time in days", censor.size=6, size=1.25, font.x=c(14, "bold"), font.y=c(14, "bold"),
size=1.5, font.tickslab=c(12), legend.labs=c("L", "S"))
S.curv.M.allele
ggsave("Plots/Survival_curve_M_allele.png")
## chro
fit.M.chro <- survfit(Surv(day, censor) ~ chro, data=agefruM)
S.curv.M.chro <- ggsurvplot(fit.M.chro, data=agefruM, pval=T, palette = c('#ffd24d', '#b06bc7'),
xlab="Time in days", censor.size=6, size=1.25, font.x=c(14, "bold"), font.y=c(14, "bold"),
font.tickslab=c(12), legend.labs=c("Balancer", "Deletion"))
S.curv.M.chro
ggsave("Plots/Survival_curve_M_chro.png")
## allele chro
fit.M.A.C <- survfit(Surv(day, censor) ~ allele.chro, data=agefruM)
S.curv.M.AxC <- ggsurvplot(fit.M.A.C, data=agefruM, pval=T, palette = 'jama',
xlab="Time in days", censor.size=6, size=1.25, font.x=c(14, "bold"), font.y=c(14, "bold"),
font.tickslab=c(12), legend.labs=c("L allele balancer", "L allele deletion", "S allele balancer", 'S allele deletion'))
S.curv.M.AxC
ggsave("Plots/Survival_curve_M_allelexchro.png")
##allele
fit.F.allele <- survfit(Surv(day, censor) ~ allele, data=agefruF)
S.curv.F.allele <- ggsurvplot(fit.F.allele, data=agefruF, pval=T, palette = c('#ca3542', '#7a8ed9'),
xlab="Time in days", xlim=c(0,100), break.x.by=25, censor.size=6, size=1.25,
font.x=c(14, "bold"), font.y=c(14, "bold"),
font.tickslab=c(12), legend.labs=c("L", "S"))
S.curv.F.allele
ggsave("Plots/Survival_curve_F_allele.png")
## chro
fit.F.chro <- survfit(Surv(day, censor) ~ chro, data=agefruF)
S.curv.F.chro <- ggsurvplot(fit.F.chro, data=agefruF, pval=T, palette = c('#ffd24d', '#b06bc7'),
xlab="Time in days", xlim=c(0,100), break.x.by=25, censor.size=6, size=1.25,
font.x=c(14, "bold"), font.y=c(14, "bold"),
font.tickslab=c(12), legend.labs=c("Balancer", "Deletion"))
S.curv.F.chro
ggsave("Plots/Survival_curve_F_chro.png")
## allele chro
fit.F.A.C <- survfit(Surv(day, censor) ~ allele.chro, data=agefruF)
S.curv.F.AxC <- ggsurvplot(fit.F.A.C, data=agefruF, pval=T, palette = 'jama',
xlab="Time in days", xlim=c(0,100), break.x.by=25, censor.size=6, size=1.25,
font.x=c(14, "bold"), font.y=c(14, "bold"),
font.tickslab=c(12), legend.labs=c("L allele balancer", "L allele deletion", "S allele balancer", 'S allele deletion'))
S.curv.F.AxC
ggsave("Plots/Survival_curve_F_allelexchro.png")
# female flies
term <- c("alleleS", "chromosomeD", 'alleleS:chromosomeD')
h.ratio <- c(1.3814, 0.5423, 0.6114)
min.D <- c(1.1565, 0.4491, 0.4685)
max.D <- c(1.65, 0.6548, 0.798)
F.HR <- data.frame(Term = term, HR = h.ratio, HR.min = min.D, HR.max = max.D)
F.HR
levels(F.HR$Term)
F.HR$Term <- factor(F.HR$Term, levels = c("alleleS", "chromosomeD", "alleleS:chromosomeD"))
levels(F.HR$Term)
HR.plot.F<- ggplot(aes(x=Term, y=HR, color=Term), data=F.HR)+
geom_point(aes(size=10))+
geom_errorbar(aes(ymin=(min.D), ymax=(max.D)), size=2)+
geom_hline(yintercept = 1)+
ylab("Hazard-ratio")+
xlab("Term in Cox model")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=25))+
scale_color_jama()
HR.plot.F
library(ggsci)
library(RColorBrewer)
HR.plot.F<- ggplot(aes(x=Term, y=HR, color=Term), data=F.HR)+
geom_point(aes(size=10))+
geom_errorbar(aes(ymin=(min.D), ymax=(max.D)), size=2)+
geom_hline(yintercept = 1)+
ylab("Hazard-ratio")+
xlab("Term in Cox model")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=25))+
scale_color_jama()
HR.plot.F
ggsave("Plots/HZ/F_HR_plot.png")
# male flies
term <- c("alleleS", "chromosomeD", 'alleleS:chromosomeD')
h.ratio <- c(1.0385, 1.3008, 0.7724)
min.D <- c(0.8539, 1.0611, 0.5798)
max.D <- c(1.263, 1.595, 1.029)
M.HR <- data.frame(Term = term, HR = h.ratio, HR.min = min.D, HR.max = max.D)
M.HR
levels(M.HR$Term)
M.HR$Term <- factor(F.HR$Term, levels = c("alleleS", "chromosomeD", "alleleS:chromosomeD"))
HR.plot.M<- ggplot(aes(x=Term, y=HR, color=Term), data=M.HR)+
geom_point(aes(size=10))+
geom_errorbar(aes(ymin=(min.D), ymax=(max.D)), size=2)+
geom_hline(yintercept = 1)+
ylab("Hazard-ratio")+
xlab("Term in Cox model")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=25))+
scale_color_jama()
HR.plot.M
ggsave("Plots/HZ/M_HR_plot.png")
# B flies
term <- c("alleleS", "sexM", 'alleleS:sexM')
h.ratio <- c(1.3857, 0.5719, 0.7308)
min.D <- c(1.16, 0.4724, 0.5605)
max.D <- c(1.6554, 0.6924, 0.9527)
B.HR <- data.frame(Term = term, HR = h.ratio, HR.min = min.D, HR.max = max.D)
B.HR
levels(B.HR$Term)
B.HR$Term <- factor(B.HR$Term, levels = c("alleleS", "sexM", "alleleS:sexM"))
HR.plot.B <- ggplot(aes(x=Term, y=HR, color=Term), data=B.HR)+
geom_point(aes(size=10))+
geom_errorbar(aes(ymin=(min.D), ymax=(max.D)), size=2)+
geom_hline(yintercept = 1)+
ylab("Hazard-ratio")+
xlab("Term in Cox model")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=25))+
scale_color_jama()
HR.plot.B
ggsave("Plots/HZ/B_HR_plot.png")
# D flies
term <- c("alleleS", "sexM", 'alleleS:sexM')
h.ratio <- c(0.8702, 1.3204, 0.927)
min.D <- c(0.7153, 1.0805, 0.6963)
max.D <- c(1.059, 1.614, 1.234)
D.HR <- data.frame(Term = term, HR = h.ratio, HR.min = min.D, HR.max = max.D)
D.HR
levels(D.HR$Term)
D.HR$Term <- factor(D.HR$Term, levels = c("alleleS", "sexM", "alleleS:sexM"))
HR.plot.D<- ggplot(aes(x=Term, y=HR, color=Term), data=D.HR)+
geom_point(aes(size=10))+
geom_errorbar(aes(ymin=(min.D), ymax=(max.D)), size=2)+
geom_hline(yintercept = 1)+
ylab("Hazard-ratio")+
xlab("Term in Cox model")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=25))+
scale_color_jama()
HR.plot.D
ggsave("Plots/HZ/D_HR_plot.png")
## all flies
term <- c("alleleS", "chroD", "SexM", 'alleleS:chroD', "alleleS:SexM", "chroD:SexM")
h.ratio <- c(1.3183, 0.5156, 0.5305, 0.6925, 0.8209, 2.6241)
min.D <- c(1.1259, 0.4395, 0.4488, 0.5701, 0.6762, 2.1535)
max.D <- c(1.5437, 0.6119, 0.627, 0.8412, 0.9966, 3.1976)
T.HR <- data.frame(Term = term, HR = h.ratio, HR.min = min.D, HR.max = max.D)
T.HR
levels(T.HR$Term)
T.HR$Term <- factor(T.HR$Term, levels = c("alleleS", "chroD", "SexM", 'alleleS:chroD', "alleleS:SexM", "chroD:SexM"))
HR.plot.T<- ggplot(aes(x=Term, y=HR, color=Term), data=T.HR)+
geom_point(aes(size=10))+
geom_errorbar(aes(ymin=(min.D), ymax=(max.D)), size=2)+
geom_hline(yintercept = 1)+
ylab("Hazard-ratio")+
xlab("Term in Cox model")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=20))+
scale_color_jama()
HR.plot.T
HR.plot.T<- ggplot(aes(x=Term, y=HR, color=Term), data=T.HR)+
geom_point(aes(size=10))+
geom_errorbar(aes(ymin=(min.D), ymax=(max.D)), size=2)+
geom_hline(yintercept = 1)+
ylab("Hazard-ratio")+
xlab("Term in Cox model")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=20))+
scale_color_jama()
HR.plot.T
ggsave("Plots/HZ/T_HR_plot.png")
# with data from combined models above
model <- c("D flies", "B flies", "Males", "Females")
Haz_R <- c(0.8702, 1.3857, 1.0385, 1.3414)
minHR <- c(0.7153, 1.16, 0.8539, 1.1565)
maxHR <- c(1.059, 1.6554, 1.2663, 1.65)
C.HR <- data.frame(Model = model, HR = Haz_R, HR.min = minHR, HR.max = maxHR)
levels(C.HR$Model)
HR.comp.1 <- ggplot(aes(x=Term, y=HR, color=Model), data=C.HR)+
geom_point(aes(size=10))+
geom_errorbar(aes(ymin=(min.D), ymax=(max.D)), size=2)+
geom_hline(yintercept = 1)+
ylab("Hazard-ratio")+
xlab("Term in Cox model")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=25))+
scale_color_jama()
HR.plot.F
HR.comp.1 <- ggplot(aes(x=Term, y=HR, color=Model), data=C.HR)+
geom_point(size=5)+
geom_errorbar(aes(ymin=(min.D), ymax=(max.D)), size=2)+
geom_hline(yintercept = 1)+
ylab("Hazard-ratio")+
xlab("Term in Cox model")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=25))+
scale_color_jama()
HR.plot.F
HR.comp.1 <- ggplot(aes(x=Model, y=HR, color=Model), data=C.HR)+
geom_point()+
geom_errorbar(aes(ymin=(min.D), ymax=(max.D)), size=2)+
geom_hline(yintercept = 1)+
ylab("Hazard-ratio")+
xlab("Term in Cox model")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=25))+
scale_color_jama()
HR.plot.F
HR.comp.1 <- ggplot(aes(x=Model, y=HR, color=Model), data=C.HR)+
geom_point()+
geom_errorbar(aes(ymin=(HR.min), ymax=(HR.max), data=C.HR), size=2)+
geom_hline(yintercept = 1)+
ylab("Hazard-ratio")+
xlab("Term in Cox model")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=25))+
scale_color_jama()
HR.plot.F
HR.comp.1 <- ggplot(aes(x=Model, y=HR, color=Model), data=C.HR)+
geom_point()+
geom_errorbar(aes(ymin=(minHR), ymax=(maxHR)), size=2)+
geom_hline(yintercept = 1)+
ylab("Hazard-ratio")+
xlab("Term in Cox model")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=25))+
scale_color_jama()
HR.plot.F
C.HR
HR.comp.1
ggsave("Plots/HZ/HR_Sallele_from_models.png")
chrosex_split <- split(agefruD, agefruD$sex)
chrosex_split
agefruDF <- chrosex_split[[1]]
agefruDM <- chrosex_split[[2]]
chroBsex_split <- split(agefruB, agefruB$sex)
agefruBF <- chroBsex_split[[1]]
agefruBM <- chroBsex_split[[2]]
## models
DF.surv <- coxph(Surv(day, censor) ~ allele, data=agefruDF)
DM.surv <- coxph(Surv(day, censor) ~ allele, data=agefruDM)
BF.surv <- coxph(Surv(day, censor) ~ allele, data=agefruBF)
BM.surv <- coxph(Surv(day, censor) ~ allele, data=agefruBM)
# MODEL OUPUT
# D females
summary(DF.surv)
# D males
summary(DM.surv)
# B females
summary(BF.surv)
# B males
summary(BM.surv)
## plot this
term <- c("B Males", "B Females", 'D Males', "D Females")
chro <- c("B", "B", "D", "D")
sex <- c ("M", "F", "M", "F")
h.ratio <- c(1.037, 1.341, 0.8322, 0.8464)
min.D <- c(0.8517, 1.121, 0.6746, 0.6945)
max.D <- c(1.264, 1.603, 1.026, 1.031)
S.HR <- data.frame(Term = term, HR = h.ratio, HR.min = min.D, HR.max = max.D, chromosome = chro, sex = sex)
S.HR
levels(S.HR$Term)
S_HR.plots.single.term.models<- ggplot(aes(x=Term, y=HR, color=sex), data=S.HR)+
geom_point(size=3)+
geom_errorbar(aes(ymin=(min.D), ymax=(max.D)), size=2)+
geom_hline(yintercept = 1)+
ylab("H-R of S allele")+
xlab("Sex and chromosome combination")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=25))+
scale_colour_manual(values=c("#E69F00", "#009E73"))+
facet_wrap(~chromosome,scales="free_x")
S_HR.plots.single.term.models
S_HR.plots.single.term.models<- ggplot(aes(x=Term, y=HR, color=sex), data=S.HR)+
geom_point(size=5)+
geom_errorbar(aes(ymin=(min.D), ymax=(max.D)), size=2)+
geom_hline(yintercept = 1)+
ylab("H-R of S allele")+
xlab("Sex and chromosome combination")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=25))+
scale_colour_manual(values=c("#E69F00", "#009E73"))+
facet_wrap(~chromosome,scales="free_x")
S_HR.plots.single.term.models
HR.plot.D<- ggplot(aes(x=Term, y=HR, color=Term), data=D.HR)+
geom_point(aes(size=10))+
geom_errorbar(aes(ymin=(min.D), ymax=(max.D)), size=2)+
geom_hline(yintercept = 1)+
ylab("Hazard-ratio")+
xlab("Term in Cox model")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=25))+
scale_color_jama()
HR.plot.D
# D flies
term <- c("alleleS", "sexM", 'alleleS:sexM')
h.ratio <- c(0.8702, 1.3204, 0.927)
min.D <- c(0.7153, 1.0805, 0.6963)
max.D <- c(1.059, 1.614, 1.234)
D.HR <- data.frame(Term = term, HR = h.ratio, HR.min = min.D, HR.max = max.D)
D.HR
levels(D.HR$Term)
D.HR$Term <- factor(D.HR$Term, levels = c("alleleS", "sexM", "alleleS:sexM"))
HR.plot.D<- ggplot(aes(x=Term, y=HR, color=Term), data=D.HR)+
geom_point(aes(size=10))+
geom_errorbar(aes(ymin=(min.D), ymax=(max.D)), size=2)+
geom_hline(yintercept = 1)+
ylab("Hazard-ratio")+
xlab("Term in Cox model")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=25))+
scale_color_jama()
HR.plot.D
ggsave("Plots/HZ/D_HR_plot.png")
## plot this
term <- c("B Males", "B Females", 'D Males', "D Females")
chro <- c("B", "B", "D", "D")
sex <- c ("M", "F", "M", "F")
h.ratio <- c(1.037, 1.341, 0.8322, 0.8464)
min.D <- c(0.8517, 1.121, 0.6746, 0.6945)
max.D <- c(1.264, 1.603, 1.026, 1.031)
S.HR <- data.frame(Term = term, HR = h.ratio, HR.min = min.D, HR.max = max.D, chromosome = chro, sex = sex)
S.HR
levels(S.HR$Term)
S_HR.plots.single.term.models<- ggplot(aes(x=Term, y=HR, color=sex), data=S.HR)+
geom_point(size=5)+
geom_errorbar(aes(ymin=(min.D), ymax=(max.D)), size=2)+
geom_hline(yintercept = 1)+
ylab("H-R of S allele")+
xlab("Sex and chromosome combination")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=25))+
scale_colour_manual(values=c("#E69F00", "#009E73"))+
facet_wrap(~chromosome,scales="free_x")
S_HR.plots.single.term.models
ggsave("Plots/HZ/simple_model_Sallele_plot.png")
HR.comp.1 <- ggplot(aes(x=Model, y=HR, color=Model), data=C.HR)+
geom_point()+
geom_errorbar(aes(ymin=(minHR), ymax=(maxHR)), size=2)+
geom_hline(yintercept = 1)+
ylab("Hazard-ratio of the S allele")+
xlab("Subset of data")+
theme_bw()+
theme(legend.title=element_blank(),axis.text = element_text(size=25),
axis.title = element_text(size=30),legend.position = "none",strip.text=element_text(size=25))+
scale_color_jama()
HR.comp.1
ggsave("Plots/HZ/HR_Sallele_from_models.png")
